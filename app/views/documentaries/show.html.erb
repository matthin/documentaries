<div>
  <h1><%= @documentary.title %></h1>
  <p><%= @documentary.description %></p>
  <% if @documentary.video_service == 'youtube' %>
    <iframe id="ytplayer" type="text/html" width="640" height="360"
        src="//www.youtube.com/embed/<%= @documentary.video_source %>"
        frameborder="0" allowfullscreen></iframe>
  <% end %>
  <h3>Uploaded by <a href="/user/view/<%= @documentary.uploader_user.to_s %>">
      <%= @documentary_user %></a></h3>
  <span><%= @documentary.likes %> likes, and</span>
  <span><%= @documentary.dislikes %> dislikes</span>
  <p>Category: <%= link_to(@documentary.category, '/search?utf8=âœ“&commit=Search&' \
      "search=\"category:#{@documentary.category}\"") %></p>
  <% if @documentary.uploader_user == session[:user_id] %>
    <a href="<%= documentary_edit_url(@documentary)%>"
        class="btn btn-default">Edit Documentary</a>
  <% end %>
</div>

<% if current_user && !@review.message %>
  <%= form_for(@review, url: reviews_path, html: { :role => 'form',
      :class => 'form-horizontal' }) do |f| %>
    <% if @review.errors.any? %>
      <div class="error_messages">
      <h2>Form is invalid</h2>
      <ul>
        <% for message in @review.errors.full_messages %>
          <li><%= message %></li>
        <% end %>
      </ul>
      </div>
    <% end %>
    <div class="form-group">
      <input type="hidden" name="review[documentary_id]"
          value="<%= @documentary.id %>" />
    </div>
    <div class="form-group">
      <%= f.label :message, 'Review', class: 'control-label col-sm-2' %>
      <div class="col-sm-5">
        <%= f.text_area :message, class: 'form-control',
            placeholder: 'Test Message' %>
      </div>
    </div>
    <div class="form-group">
    <div class="radio col-sm-offset-2">
      <label>
        <input type="radio" name="review[is_positive]" value="true" checked>
        Liked
      </label>
    </div>
    <div class="radio col-sm-offset-2">
      <label>
        <input type="radio" name="review[is_positive]" value="false">
        Disliked
      </label>
    </div>
    <div class="form-group" style="padding-top:10px;">
      <div class="col-sm-offset-2 col-sm-10">
        <button type="submit" class="btn btn-default">Submit</button>
      </div>
    </div>
  <% end %>
<% elsif current_user %>
  <%= form_for(@review, url: review_update_path, method: :patch,
      html: { :role => 'form', :class => 'form-horizontal' }) do |f| %>
    <% if @review.errors.any? %>
      <div class="error_messages">
      <h2>Form is invalid</h2>
      <ul>
        <% for message in @review.errors.full_messages %>
          <li><%= message %></li>
        <% end %>
      </ul>
      </div>
    <% end %>
    <div class="form-group">
      <input type="hidden" name="review[documentary_id]"
          value="<%= @documentary.id %>" />
    </div>
    <div class="form-group">
      <%= f.label :message, 'Review', class: 'control-label col-sm-2' %>
      <div class="col-sm-5">
        <%= f.text_area :message, class: 'form-control',
            placeholder: 'Test Message', value: @review.message %>
      </div>
    </div>
    <div class="form-group">
    <div class="radio col-sm-offset-2">
      <label>
        <input type="radio" name="review[is_positive]" value="true" <%= @review.is_positive == true ? 'checked' : nil %>>
        Liked
      </label>
    </div>
    <div class="radio col-sm-offset-2">
      <label>
        <input type="radio" name="review[is_positive]" value="false" <%= @review.is_positive == false ? 'checked' : nil %>>
        Disliked
      </label>
    </div>
    <div class="form-group" style="padding-top:10px;">
      <div class="col-sm-offset-2 col-sm-10">
        <button type="submit" class="btn btn-default">Update</button>
      </div>
    </div>
  <% end %>
<% end %>

<% @reviews.each do |review| %>
  <hr>
  <p><%= review.message %></p>
  <p><%= review.is_positive ? 'Liked' : 'Disliked' %></p>
  <p>Posted by <a href="/user/view/<%= review.user_id %>">
      <%= User.find(review.user_id).username %></a></p>
<% end %>
